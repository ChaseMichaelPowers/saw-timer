<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Saw Timer Admin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { background:#111;color:#eee;font-family:system-ui;padding:20px }
    button { background:#d90429;color:#fff;border:0;padding:10px 16px;margin:6px;border-radius:10px;cursor:pointer }
    input { padding:8px;font-size:16px;margin-right:8px;width:7rem;text-align:center }
    #status{margin-top:10px;color:#9be29b}
    #error{margin-top:10px;color:#ff8a8a}
  </style>
</head>
<body>
  <h1>‚è± Saw Timer Admin</h1>
  <div>
    <label>Minutes: <input id="minutes" type="number" min="0" value="8"></label>
  </div>
  <div>
    <button id="start">Start</button>
    <button id="stop">Stop</button>
    <button id="reset">Reset</button>
    <button id="prank">üòà Prank (‚Üí 1:00)</button>
    <button id="jumpBack">‚Ü© 4:00</button>
  </div>
  <div id="status"></div>
  <div id="error"></div>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io();
    const keyParam = new URLSearchParams(location.search).get('key');
    const key = keyParam || prompt("Admin Key:");
    const minutesEl = document.getElementById('minutes');
    const statusEl = document.getElementById('status');
    const errorEl  = document.getElementById('error');

    function send(type, extra={}) { socket.emit('admin', { key, type, ...extra }); }
    function ok(msg){ statusEl.textContent = msg; errorEl.textContent=''; }
    function err(msg){ errorEl.textContent = msg; statusEl.textContent=''; }

    socket.on('admin-ack', p => (p.ok ? ok(p.msg) : err(p.msg)));
    socket.on('connect', ()=> ok('Connected'));
    socket.on('disconnect', ()=> err('Disconnected'));

    document.getElementById('start').onclick = ()=>{
      const m = parseInt(minutesEl.value || '0', 10);
      if (!m) return err('Enter minutes > 0 before Start');
      send('start', { seconds: m*60 });
      ok(`Start ${m}:00`);
    };
    document.getElementById('stop').onclick    = ()=> { send('stop'); ok('Stopped'); };
    document.getElementById('reset').onclick   = ()=> { send('reset'); ok('Reset'); };
    document.getElementById('prank').onclick   = ()=> { send('prank'); ok('Prank fired'); };
    document.getElementById('jumpBack').onclick= ()=> { send('jumpBack'); ok('Jumped to 4:00'); };
  </script>
</body>
</html>
